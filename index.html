<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>kenoo</title>
  <style>
    .quiz-container {
      position: relative;
      flex: 1;
    }

    .fullscreen-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 10;
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 6px 10px;
      border-radius: 4px;
      cursor: pointer;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
</head>
<body>
  <div id="container" style="min-height:100px;">Yoxlanılır...</div>

  <script>
    const allowedIPs = [
      "37.114.162.55",
      "45.15.43.70",
      "37.61.112.204",
      "82.194.6.20",
      "185.146.112.35",
      "185.146.113.192",
      "94.20.42.211"
    ];

    async function getIP() {
      try {
        const res = await fetch('https://api.ipify.org?format=json');
        const data = await res.json();
        return data.ip;
      } catch (e) {
        console.error("IP almaq mümkün olmadı:", e);
        return null;
      }
    }

    function createQuizFrame(src) {
      const id = `iframe-${Math.random().toString(36).substr(2, 9)}`;
      return `
        <div class="quiz-container">
          <button class="fullscreen-btn" onclick="openFullscreen('${id}')">Tam Ekran</button>
          <iframe id="${id}" src="${src}" allowfullscreen></iframe>
        </div>
      `;
    }

    function openFullscreen(id) {
      const iframe = document.getElementById(id);
      if (iframe.requestFullscreen) iframe.requestFullscreen();
      else if (iframe.webkitRequestFullscreen) iframe.webkitRequestFullscreen();
      else if (iframe.msRequestFullscreen) iframe.msRequestFullscreen();
    }

    async function checkAndRender() {
      const ip = await getIP();
      if (!ip) {
        document.getElementById("container").innerText = "IP yoxlanıla bilmədi.";
        return;
      }

      if (allowedIPs.includes(ip)) {
        localStorage.setItem("ip_access_granted", "1");
        document.getElementById("container").innerHTML = `
          <div style="width:100%;display:flex;flex-direction:column;gap:8px;min-height:635px;">
            ${createQuizFrame("https://quizizz.com/embed/quiz/683dddfd79bab9c70d96170f")}
            ${createQuizFrame("https://quizizz.com/embed/quiz/683dde151f8214ac74f7703d")}
            ${createQuizFrame("https://quizizz.com/embed/quiz/683dde314708a5aad48cb67f")}
            <a href="https://quizizz.com/admin?source=embedFrame" target="_blank">Explore more at Quizizz.</a>
          </div>
        `;
      } else {
        localStorage.removeItem("ip_access_granted");
        document.getElementById("container").innerHTML = `<p style="color:red;">Bu IP ilə girişə icazə verilmir.</p>`;
      }
    }

    // Səhifə yüklənəndə yoxla
    window.onload = () => {
      if (localStorage.getItem("ip_access_granted") === "1") {
        checkAndRender(); // Refresh edilsə belə yoxlamanı davam etdir
      } else {
        checkAndRender();
      }
    };
  </script>
</body>
</html>
